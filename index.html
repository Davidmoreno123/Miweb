<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Usuarios</title>
  <script type="module">
    // Primero, importa las funciones necesarias de Supabase
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.5.0/dist/supabase.min.js'

    // Tu configuración de Supabase (reemplaza con tus valores)
    const supabaseUrl = 'https://fcltepdtcsddeudjmzjc.supabase.co';  // Reemplaza esto con tu URL
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZjbHRlcGR0Y3NkZGV1ZGptempjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzNzk5MDgsImV4cCI6MjA2MDk1NTkwOH0.snOcWct0K2lApgjgqfjpq67R5-NZQ1kH3vwvnImzPtM';  // Reemplaza esto con tu clave pública
    const supabase = createClient(supabaseUrl, supabaseKey);

    // Función para registrar un usuario
    async function registrarUsuario() {
      const usuario = {
        nombre: document.getElementById('nombre').value,
        huella_id: document.getElementById('huella_id').value,
        contrasena: document.getElementById('contrasena').value
      };

      const { data, error } = await supabase
        .from('usuarios')
        .insert([usuario]);

      if (error) {
        console.error('Error al registrar el usuario:', error);
      } else {
        console.log('Usuario registrado:', data);
        registrarAcceso('registro de nuevo usuario'); // Registro de acceso
      }
    }

    // Función para registrar un acceso
    async function registrarAcceso(mensaje) {
      const acceso = {
        mensaje,
        hora: new Date().toISOString()
      };

      const { data, error } = await supabase
        .from('logs')
        .insert([acceso]);

      if (error) {
        console.error('Error al registrar el acceso:', error);
      } else {
        console.log('Acceso registrado:', data);
      }
    }

    // Función para ver los logs
    async function verLogs() {
      const { data, error } = await supabase
        .from('logs')
        .select('*');

      if (error) {
        console.error('Error al ver los logs:', error);
      } else {
        console.log('Logs:', data);
      }
    }
  </script>
</head>
<body>

  <h1>Registro de Usuario</h1>

  <label for="nombre">Nombre:</label>
  <input type="text" id="nombre" name="nombre">
  <br>

  <label for="huella_id">ID de Huella:</label>
  <input type="text" id="huella_id" name="huella_id">
  <br>

  <label for="contrasena">Contraseña:</label>
  <input type="password" id="contrasena" name="contrasena">
  <br><br>

  <button onclick="registrarUsuario()">Registrar Usuario</button>
  <br><br>
  
  <button onclick="verLogs()">Ver Logs de Acceso</button>

</body>
</html>

